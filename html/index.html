<!doctype html>
<!--
  Material Design Lite
  Copyright 2015 Google Inc. All rights reserved.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      https://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License
-->
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Ein Websolver für das Technician Dispatch Problem">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>Technician Dispatch Problem</title>

    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=de">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.teal-orange.min.css"/>
    <link rel="stylesheet" href="styles.css">
</head>
<body onload="resetAdvanced(); clearSolutions();">
<div class="tdp-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100">
    <header class="tdp-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800">
        <div class="mdl-layout__header-row">
            <img id="kit-logo" src="kit_logo.png">
            <div class="h-space-30"></div>
            <span class="mdl-layout-title">Technician Dispatch Problem</span>
            <div class="mdl-layout-spacer"></div>
        </div>
    </header>
    <div class="tdp-ribbon"></div>
    <div id="tdp-toast-example" class="mdl-js-snackbar mdl-snackbar">
        <div class="mdl-snackbar__text"></div>
        <button class="mdl-snackbar__action" type="button"></button>
    </div>
    <main class="tdp-main mdl-layout__content">
        <div class="tdp-container mdl-grid">
            <div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
            <div class="tdp-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">
                <div class="tdp-crumbs mdl-color-text--grey-500">
                    Technician Dispatch Problem > Simulator
                </div>
                <h3>Simulator</h3>
                <form action="#">
                    <div class="mdl-grid">
                        <div class="mdl-cell mdl-cell--6-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                <input class="mdl-textfield__input" type="text" pattern="\d*"
                                       id="techniker" name="techniker" value="2">
                                <label class="mdl-textfield__label" for="techniker">Anzahl Techniker</label>
                                <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                            </div>
                        </div>
                        <div class="mdl-cell mdl-cell--6-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                <input class="mdl-textfield__input" type="text" pattern="\d*"
                                       id="auftraege" name="auftraege" value="4">
                                <label class="mdl-textfield__label" for="auftraege">Anzahl Aufträge</label>
                                <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                            </div>
                        </div>
                    </div>
                    <div class="mdl-grid">
                        <div class="mdl-cell mdl-cell--6-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                <input class="mdl-textfield__input" type="text" pattern="\d*"
                                       id="tageslaenge" name="tageslaenge" value="500">
                                <label class="mdl-textfield__label" for="tageslaenge">Tageslänge (Arbeitszeit) in
                                    min</label>
                                <span class="mdl-textfield__error">Länge muss eine Zahl sein</span>
                            </div>
                        </div>
                        <div class="mdl-cell mdl-cell--6-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                <input class="mdl-textfield__input" type="text" pattern="\d*"
                                       id="maxTageslaenge" name="maxTageslaenge" value="600">
                                <label class="mdl-textfield__label" for="maxTageslaenge">Maximale Arbeitzeit in
                                    min</label>
                                <span class="mdl-textfield__error">Länge muss eine Zahl sein</span>
                            </div>
                        </div>
                    </div>
                    <div class="mdl-grid">
                        <div class="mdl-cell mdl-cell--6-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                <input class="mdl-textfield__input" type="text" pattern="\d*"
                                       id="skills" name="skills" value="2" onchange="updateReplanRegex()">
                                <label class="mdl-textfield__label" for="skills">Skillsetgröße</label>
                                <span class="mdl-textfield__error">Größe muss eine Zahl sein</span>
                            </div>
                        </div>
                        <div class="mdl-cell mdl-cell--6-col">
                            <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-advanced">
                                <input type="checkbox" id="switch-advanced" class="mdl-switch__input"
                                       onchange="toggleAdvanced()">
                                <span class="mdl-switch__label">Erweiterter Modus</span>
                            </label>
                        </div>
                    </div>
                    <div id="panel-advanced" style="display: none">
                        <h5>Erweiterte Einstellungen</h5>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="seed" name="seed" value="">
                                    <label class="mdl-textfield__label" for="seed">Zufallsseed</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>

                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--12-col">
                                <h6>Zufallsverteilungen für Modellparameter (Distanzen und Zeiten werden in Minuten
                                    bemessen).
                                    Warnung: Unterschiedliche Werte für die Zufallsbereiche sind trotz gleichem Seed
                                    nicht mehr vergleichbar!</h6>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="minDistanz" name="minDistanz" value="">
                                    <label class="mdl-textfield__label" for="minDistanz">Min. Distanz
                                        (gleichverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="maxDistanz" name="maxDistanz" value="">
                                    <label class="mdl-textfield__label" for="maxDistanz">Max. Distanz
                                        (gleichverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="minStart" name="minStart" value="">
                                    <label class="mdl-textfield__label" for="minStart">Min. Startzeit Auftrag
                                        (gleichverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="maxStart" name="maxStart" value="">
                                    <label class="mdl-textfield__label" for="maxStart">Max. Startzeit Auftrag
                                        (gleichverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="eDauer" name="eDauer" value="">
                                    <label class="mdl-textfield__label" for="maxDistanz">Erwartungswert Auftragsdauer
                                        (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="maxDauer" name="maxDauer" value="">
                                    <label class="mdl-textfield__label" for="maxDauer">Max. Auftragsdauer
                                        (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="eEnde" name="eEnde" value="">
                                    <label class="mdl-textfield__label" for="eEnde">Erwartungswert Pufferzeit
                                        Auftragsende (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="maxEnde" name="maxEnde" value="">
                                    <label class="mdl-textfield__label" for="maxEnde">Max. Pufferzeit Auftragsende
                                        (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="eStrafeAuftrag" name="eStrafeAuftrag" value="">
                                    <label class="mdl-textfield__label" for="eStrafeAuftrag">Erwartungswert
                                        Auftragsstrafe pro min (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="maxStrafeAuftrag" name="maxStrafeAuftrag" value="">
                                    <label class="mdl-textfield__label" for="maxStrafeAuftrag">Max. Auftragsstrafe pro
                                        min (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="eStrafeTechniker" name="eStrafeTechniker" value="">
                                    <label class="mdl-textfield__label" for="eStrafeTechniker">Erwartungswert
                                        Technikerstrafe pro min (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field" type="text"
                                           pattern="\d*"
                                           id="maxStrafeTechniker" name="maxStrafeTechniker" value="">
                                    <label class="mdl-textfield__label" for="maxStrafeTechniker">Max. Technikerstrafe
                                        pro min (binomialverteilt)</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-replanning">
                                    <input type="checkbox" id="switch-replanning" class="mdl-switch__input"
                                           onchange="toggleReplan()">
                                    <span class="mdl-switch__label">Replanning aktivieren</span>
                                </label>
                            </div>
                        </div>
                        <h5>Replanning</h5>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input replanning-field" type="text" pattern="\d*"
                                           id="reZeitpunkt" name="reZeitpunkt">
                                    <label class="mdl-textfield__label" for="reZeitpunkt">Replanningzeitpunkt</label>
                                    <span class="mdl-textfield__error">Replanningzeitpunkt muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <h6>Neuer Auftrag</h6>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field replanning-field" type="text"
                                           pattern="\d*"
                                           id="reFruesterStart" name="reFruesterStart" value="">
                                    <label class="mdl-textfield__label" for="reFruesterStart">Frühster Start</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field replanning-field" type="text"
                                           pattern="\d*"
                                           id="reSpaetestesEnde" name="reSpaetestesEnde" value="">
                                    <label class="mdl-textfield__label" for="reSpaetestesEnde">Spätestes Ende</label>
                                    <span class="mdl-textfield__error">Anzahl muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field replanning-field" type="text"
                                           pattern="\d*"
                                           id="reDauer" name="reDauer" value="">
                                    <label class="mdl-textfield__label" for="reDauer">Auftragsdauer</label>
                                    <span class="mdl-textfield__error">Auftragsdauer muss eine Zahl sein</span>
                                </div>
                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field replanning-field" type="text"
                                           pattern="\d*"
                                           id="reStrafe" name="reStrafe" value="">
                                    <label class="mdl-textfield__label" for="reStrafe">Technikerstrafe pro min</label>
                                    <span class="mdl-textfield__error">Technikerstrafe muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                        <div class="mdl-grid">
                            <div class="mdl-cell mdl-cell--6-col">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <input class="mdl-textfield__input advanced-field replanning-field" type="text"
                                           pattern="([01],){1}[01]{1}"
                                           id="reSkills" name="reSkills" value="">
                                    <label class="mdl-textfield__label" for="reSkills">Skillset (Format: 0,1,0)</label>
                                    <span class="mdl-textfield__error">Auftragsdauer muss eine Zahl sein</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"
                        onclick="processInput()" id="btnSolve">
                    Modell generieren und lösen
                </button>
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"
                        onclick="cancel()" id="btnCancel" disabled>
                    Abbrechen
                </button>
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"
                        onclick="clearSolutions()" id="btnClear" disabled>
                    Lösungen leeren
                </button>

                <div class="mdl-grid">
                    <div class="mdl-cell">
                        <div id="progress_indicator" class="mdl-progress mdl-js-progress mdl-progress__indeterminate"
                             style="display: none"></div>
                    </div>
                </div>
                <div class="solution-container">

                </div>
            </div>
        </div>
        <footer class="tdp-footer mdl-mini-footer">
            <div class="mdl-mini-footer--left-section">
                <ul class="mdl-mini-footer--link-list">
                    <li><a href="#">Eine Arbeit von Sebastian Lauber und Yusuf Günes</a></li>
                </ul>
            </div>
        </footer>
    </main>
</div>
<script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<script type="application/javascript">
    var xhttp = new XMLHttpRequest();

    function processInput() {
        var progress_indicator = document.querySelector('#progress_indicator');
        progress_indicator.style.display = "block";
        var cancel_button = document.querySelector('#btnCancel');
        cancel_button.disabled = false;
        var solve_button = document.querySelector('#btnSolve');
        solve_button.disabled = true;
        var inputs = document.getElementsByTagName("INPUT");
        for (var i = 0; i < inputs.length; i++) {
            if (inputs[i].type === 'text') {
                inputs[i].disabled = true;
            }
        }

        var techniker = document.querySelector('#techniker').value;
        var auftraege = document.querySelector('#auftraege').value;
        var skills = document.querySelector('#skills').value;
        var seed = document.querySelector('#seed').value;
        var tageslaenge = document.querySelector('#tageslaenge').value;
        var maxTageslaenge = document.querySelector('#maxTageslaenge').value;

        var minDistanz = document.querySelector('#minDistanz').value;
        var maxDistanz = document.querySelector('#maxDistanz').value;
        var minStart = document.querySelector('#minStart').value;
        var maxStart = document.querySelector('#maxStart').value;
        var maxDauer = document.querySelector('#maxDauer').value;
        var eDauer = document.querySelector('#eDauer').value;
        var maxEnde = document.querySelector('#maxEnde').value;
        var eEnde = document.querySelector('#eEnde').value;
        var maxStrafeAuftrag = document.querySelector('#maxStrafeAuftrag').value;
        var eStrafeAuftrag = document.querySelector('#eStrafeAuftrag').value;
        var maxStrafeTechniker = document.querySelector('#maxStrafeTechniker').value;
        var eStrafeTechniker = document.querySelector('#eStrafeTechniker').value;

        var replanning = document.querySelector('#switch-replanning').checked;
        var reZeitpunkt = document.querySelector('#reZeitpunkt').value;
        var reFruesterStart = document.querySelector('#reFruesterStart').value;
        var reSpaetestesEnde = document.querySelector('#reSpaetestesEnde').value;
        var reDauer = document.querySelector('#reDauer').value;
        var reStrafe = document.querySelector('#reStrafe').value;
        var reSkills = document.querySelector('#reSkills').value;


        var advancedSwitch = document.querySelector("#switch-advanced").checked;

        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                enableFields();
                var response = JSON.parse(this.responseText);
                if (response.solved === true) {
                    appendSolution(response);
                    var clear_button = document.querySelector('#btnClear');
                    clear_button.disabled = false;
                    showToast("Lösung gefunden.");
                } else {
                    showToast("Es konnte keine Lösung gefunden werden.");
                }

            } else {
                if (this.status == 500) {
                    showToast("Ein Fehler bei der Verarbeitung der Daten ist aufgetreten.");
                    cancel();
                }
            }
        };

        xhttp.open("GET",
            "http://localhost:5000/solve?techniker=" + techniker + "&auftraege=" + auftraege +
            "&skills=" + skills + "&tageslaenge=" + tageslaenge + "&maxTageslaenge=" + maxTageslaenge +
            "&seed=" + seed + "&minDistanz=" + minDistanz + "&maxDistanz=" + maxDistanz + "&minStart=" + minStart +
            "&maxStart=" + maxStart + "&maxDauer=" + maxDauer + "&eDauer=" + eDauer + "&maxEnde=" + maxEnde +
            "&eEnde=" + eEnde + "&maxStrafeAuftrag=" + maxStrafeAuftrag + "&eStrafeAuftrag=" + eStrafeAuftrag +
            "&maxStrafeTechniker=" + maxStrafeTechniker + "&eStrafeTechniker=" + eStrafeTechniker + "&advanced=" + advancedSwitch +
            "&replanning=" + replanning + "&reZeitpunkt=" + reZeitpunkt + "&reFruesterStart=" + reFruesterStart + "&reSpaetestesEnde=" + reSpaetestesEnde +
            "&reDauer=" + reDauer + "&reStrafe=" + reStrafe + "&reSkills=" + encodeURIComponent(reSkills),
            true);
        xhttp.send();

    }

    function toggleAdvanced(forceOff) {
        var advancedPanel = document.querySelector("#panel-advanced");
        var advancedSwitch = document.querySelector("#switch-advanced");
        if (!advancedSwitch.checked) {
            advancedPanel.style.display = "none";
            resetAdvanced();
            document.querySelector("#switch-replanning").checked = false;
            toggleReplan();
        } else {
            advancedPanel.style.display = "block";
        }
    }

    function toggleReplan() {
        var replanElements = document.getElementsByClassName("replanning-field");
        var replanSwitch = document.querySelector("#switch-replanning");
        for (var i = 0; i < replanElements.length; i++) {
            replanElements[i].disabled = !replanSwitch.checked;
        }
    }

    function updateReplanRegex() {
        skillsetSize = document.querySelector('#skills').value;
        console.log(skillsetSize);
        document.querySelector('#reSkills').pattern = "([01],){" + (skillsetSize - 1) + "}[01]{1}";
    }

    function enableFields() {
        var progress_indicator = document.querySelector('#progress_indicator');
        progress_indicator.style.display = "none";
        var cancel_button = document.querySelector('#btnCancel');
        cancel_button.disabled = true;
        var solve_button = document.querySelector('#btnSolve');
        solve_button.disabled = false;
        var inputs = document.getElementsByTagName("INPUT");
        for (var i = 0; i < inputs.length; i++) {
            if (inputs[i].type === 'text') {
                inputs[i].disabled = false;
            }
        }
    }

    function cancel() {
        xhttp.abort();
        enableFields()
    }

    function resetAdvanced() {
        document.querySelector('#seed').value = "";
        document.querySelector('#minDistanz').value = 0;
        document.querySelector('#maxDistanz').value = 120;
        document.querySelector('#minStart').value = 0;
        document.querySelector('#maxStart').value = 300;
        document.querySelector('#maxDauer').value = 180;
        document.querySelector('#eDauer').value = 60;
        document.querySelector('#maxEnde').value = 120;
        document.querySelector('#eEnde').value = 60;
        document.querySelector('#maxStrafeAuftrag').value = 100;
        document.querySelector('#eStrafeAuftrag').value = 25;
        document.querySelector('#maxStrafeTechniker').value = 100;
        document.querySelector('#eStrafeTechniker').value = 25;
    }

    function isArray(what) {
        return Object.prototype.toString.call(what) === '[object Array]';
    }

    /* Funktioniert mit 2D Matrizen und Listen */
    function createTable(data) {
        var table_html = "<table class='mdl-data-table'><thead><tr>";
        is2d = isArray(data[0]);

        for (var i_uber = -1; i_uber < (is2d ? data[0].length : data.length); i_uber++) {
            if (i_uber >= 0) {
                table_html += "<th>" + i_uber + "</th>";
            }
            else {
                table_html += "<th>&nbsp;</th>";
            }
        }
        table_html += "</tr></thead>";

        for (var i_matrix = 0; i_matrix < (is2d ? data.length : 1); i_matrix++) {
            table_html += "<tr>";
            for (var j_matrix = 0; j_matrix < (is2d ? data[0].length : data.length); j_matrix++) {
                if (j_matrix === 0) {
                    table_html += "<th>" + (is2d ? i_matrix : "&nbsp;") + "</th>";
                }
                table_html += "<td>" + (is2d ? data[i_matrix][j_matrix] : data[j_matrix]) + "</td>";
            }
            table_html += "</tr>";
        }
        table_html += "</table>";
        return table_html;
    }

    function appendSolution(result) {
        var d = new Date();
        var ts = d.getTime();

        var solutions = document.querySelector('.solution-container');
        var solution = document.createElement("div");
        var anzRouten = Object.keys(result.outputs.fahrten_pro_techniker_sortiert).length;

        solution.classList.add('tdp-solution-wrapper');

        var html = "<div class=\"tdp-card-wide mdl-card mdl-shadow--4dp\" id='" + ts + "'>";
        html += "<div class=\"mdl-card__title\">";
        html += "<h2 class=\"mdl-card__title-text\">Ergebnis für Seed " + result.inputs.seed + "</h2></div>";
        html += "<div class=\"mdl-card__supporting-text\">";
        if (result.inputs.replanned) {
            html += "<span>Diese Planung wurde mit Replanning durchgeführt</span><br>";
        }
        html += "<span>" + (result.outputs.alle_auftraege_erledigt ?
            "Es konnten alle Aufträge erledigt werden ✅." : "Es konnten nicht alle Aufträge erledigt werden ❌.") + "</span>";

        if (!result.outputs.alle_auftraege_erledigt) {
            html += "<h4>Unerledigte Aufträge</h4><span>" + result.outputs.unerledigte_auftraege + "</span>"
        }

        if (anzRouten > 0) {
            html += "<h4>" + (anzRouten > 1 ? "Routen" : "Route") + "</h4>";
        }

        html += "<ul class=\"tdp-list-item mdl-list\">";
        for (var key in result.outputs.fahrten_pro_techniker_sortiert) {
            if (result.outputs.fahrten_pro_techniker_sortiert.hasOwnProperty(key)) {
                html += "<li class=\"mdl-list__item\"><span class=\"mdl-list__item-primary-content\">"
                html += "<i class=\"material-icons mdl-list__item-icon\">person</i>";
                html += "Techniker " + key + " fährt von seinem Depot ";
                for (var wegpunkt_i = 1; wegpunkt_i < result.outputs.fahrten_pro_techniker_sortiert[key].length - 1; wegpunkt_i++) {
                    var auftrag = result.outputs.fahrten_pro_techniker_sortiert[key][wegpunkt_i];
                    html += "zu Auftrag " + auftrag + " (Startzeit " + result.outputs.startzeiten[parseInt(auftrag)];
                    html += "), danach ";
                }
                html += "wieder in sein Depot.</span></li>"
            }
        }
        html += "</ul>";

        html += "<div class=\"mdl-grid\"><div class=\"mdl-cell\">";
        html += "<h5>Distanzmatrix</h5>" + createTable(result.inputs.distanzmatrix);
        html += "</div></div>";

        html += "<div class=\"mdl-grid\"><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Techniker Skills</h5>" + createTable(result.inputs.techniker_skills);
        html += "</div><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Auftrag Skills</h5>" + createTable(result.inputs.auftrag_skills);
        html += "</div></div>";

        html += "<div class=\"mdl-grid\"><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Frühster Start</h5>" + createTable(result.inputs.fruester_start);
        html += "</div><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Spätestes Ende</h5>" + createTable(result.inputs.spaetestes_ende);
        html += "</div></div>";

        html += "<div class=\"mdl-grid\"><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Strafkosten Auftrag</h5>" + createTable(result.inputs.strafe_auftrag);
        html += "</div><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Strafkosten Techniker</h5>" + createTable(result.inputs.strafe_techniker);
        html += "</div></div>";

        html += "<div class=\"mdl-grid\"><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "<h5>Auftragsdauer</h5>" + createTable(result.inputs.auftragsdauer);
        html += "</div><div class=\"mdl-cell mdl-cell--6-col\">";
        html += "</div></div>";

        /* Zeitstempel */
        html += "<div><div class=\"mdl-card__actions mdl-card--border\">";
        html += "<span class=\"tdp-card-image__filename\">" + d.toLocaleString() + "</span></div>";

        /* Kartenmenü */
        html += "<div class=\"mdl-card__menu\">";
        html += "<button onclick=\"clearSolution(" + ts + ")\"";
        html += "class=\"mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect\">";
        html += "<i class=\"material-icons\">clear</i></button></div></div>";

        solution.innerHTML = html;

        solutions.insertBefore(solution, solutions.firstChild);
    }

    function clearSolution(id) {
        var node = document.getElementById(id).parentElement;
        var parent = node.parentElement;
        parent.removeChild(node);
        if (parent.children.length === 0) {
            clearSolutions();
        }
    }

    function clearSolutions() {
        var solutions = document.querySelector('.solution-container');
        solutions.innerHTML = "";
        var clear_button = document.querySelector('#btnClear');
        clear_button.disabled = true;
    }

    function showToast(text) {
        'use strict';
        var snackbarContainer = document.querySelector('#tdp-toast-example');
        var data = {message: text};
        snackbarContainer.MaterialSnackbar.showSnackbar(data);
    }


</script>
</body>
</html>
